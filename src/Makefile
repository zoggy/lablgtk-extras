#################################################################################
#                Lablgtk-extras                                                 #
#                                                                               #
#    Copyright (C) 2011 Institut National de Recherche en Informatique          #
#    et en Automatique. All rights reserved.                                    #
#                                                                               #
#    This program is free software; you can redistribute it and/or modify       #
#    it under the terms of the GNU Library General Public License as            #
#    published by the Free Software Foundation; either version 2 of the         #
#    License, or any later version.                                             #
#                                                                               #
#    This program is distributed in the hope that it will be useful,            #
#    but WITHOUT ANY WARRANTY; without even the implied warranty of             #
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the              #
#    GNU Library General Public License for more details.                       #
#                                                                               #
#    You should have received a copy of the GNU Library General Public          #
#    License along with this program; if not, write to the Free Software        #
#    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA                   #
#    02111-1307  USA                                                            #
#                                                                               #
#    Contact: Maxence.Guesdon@inria.fr                                          #
#                                                                               #
#                                                                               #
#################################################################################

include ../master.Makefile

MY_INCLUDES=
SYSTEM_INCLUDES= $(LABLGTK2_INCLUDES)

INCLUDES=$(MY_INCLUDES) $(SYSTEM_INCLUDES)

LIBS=lablgtk.cmxa lablglade.cmxa
LIBS_BYTE=$(LIBS:.cmxa=.cma)

COMPFLAGS=$(INCLUDES) -annot -g -warn-error A

GELIB_CMOFILES= \
	version.cmo \
	install.cmo

GELIB_CMXFILES=$(GELIB_CMOFILES:.cmo=.cmx)
GELIB_CMIFILES=$(GELIB_CMOFILES:.cmo=.cmi)

opt: $(GELIB)
byte:  $(GELIB_BYTE)
all: byte opt

TOOLS=
TOOLS_BYTE=

# Base
$(GELIB): $(GELIB_CMIFILES) $(GELIB_CMXFILES)
	$(OCAMLOPT) -a -o $@ $(GELIB_CMXFILES)

$(GELIB_BYTE): $(GELIB_CMIFILES) $(GELIB_CMOFILES)
	$(OCAMLC) -a -o $@ $(GELIB_CMOFILES)

#client: $(GELIB) client.ml
#	$(OCAMLOPT) -o $@ $(INCLUDES) lablgtk.cmxa lablgnomecanvas.cmxa $^

doc:
	mkdir -p ocamldoc
	ocamldoc -d ocamldoc -html $(INCLUDES) $(GELIB_CMIFILES:.cmi=.mli)

dummy:

install:
	$(MKDIR) $(BINDIR) $(LIBDIR) $(DATADIR)
	$(CP) $(GELIB) $(GELIB_BYTE) $(GELIB_CMIFILES) $(LIBDIR)/

#	$(CP) gtk/ge.glade $(DATADIR)/
#	$(CP) $(TOOLS) $(TOOLS_BYTE) $(BINDIR)/

#	$(GELIB_BYTE:.cma=.cmi) $(GELIB_BYTE:.cma=.mli)


# Clean :
#########
clean:
	$(RM) $(GENERATED_FILES) *.cm* *.so *.a *.o *.annot

distclean: clean

# depend :
##########
GENERATED_FILES=
.depend depend: $(GENERATED_FILES)
	$(RM) .depend
	$(OCAMLDEP) $(OCAMLPP) *.ml *.mli > .depend

